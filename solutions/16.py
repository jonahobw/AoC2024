import heapq
import sys

sys.setrecursionlimit(10**6)


def parseInput(inp):
    inp = [list(x) for x in inp.split("\n")]
    return inp


def solution1(inp):
    inp = parseInput(inp)
    dirs = [(1, 0), (0, -1), (-1, 0), (0, 1)]
    R = len(inp)
    start = (R - 2, 1, 3)  # row, col, dir
    vertices = {start: {"dist": 0, "prev": [], "children": []}}
    Q = []
    heapq.heappush(Q, start)
    while Q:
        vertex = heapq.heappop(Q)
        r, c, dir = vertex
        vertexDist = vertices[vertex]["dist"]
        neighbors = [
            (r, c, (dir + 1) % 4),
            (r, c, (dir + -1) % 4),
            (r + dirs[dir][0], c + dirs[dir][1], dir),
        ]
        for neighbor in neighbors:
            (newR, newC, newDir) = neighbor
            if inp[newR][newC] == "#":
                continue
            if neighbor not in vertices:
                vertices[neighbor] = {"dist": float("inf"), "prev": [], "children": []}
            neighborDist = vertices[neighbor]["dist"]
            if newDir == dir:
                newDist = 1 + vertexDist
            else:
                newDist = 1000 + vertexDist
            if neighborDist > newDist:
                vertices[neighbor]["dist"] = newDist
                vertices[neighbor]["prev"] = [vertex]
                heapq.heappush(Q, neighbor)
                vertices[vertex]["children"].append(neighbor)
            if neighborDist == newDist:
                vertices[neighbor]["prev"].append(vertex)

    minDist = float("inf")
    for dir in range(4):
        minDist = min(minDist, vertices[(1, len(inp[0]) - 2, dir)]["dist"])
    return minDist, vertices


def solution2(inp, vertices):
    inp = parseInput(inp)
    seen = set()
    seenLocs = set()
    Q = [(1, len(inp[0]) - 2, x) for x in range(4)]
    while Q:
        vertex = heapq.heappop(Q)
        (r, c, _) = vertex
        if vertex in seen:
            continue
        seen.add(vertex)
        seenLocs.add((r, c))
        prevs = vertices[vertex]["prev"]
        for prev in prevs:
            heapq.heappush(Q, prev)
    return len(seenLocs)


testinput = """\
###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############\
"""

input = """\
#############################################################################################################################################
#...#.........................#.......#...#.........#.......#...............#...............................#.......#.....#.......#........E#
#.#.#.#########.#.#.###########.#.###.#.#.#.#####.###.#.#####.#####.#.#####.#####.###.#.###.#.#.#####.#.#.#.#.#.#####.#.###.#.#####.#.#####.#
#.#.#...#.....#...#.#...#.......#.#.....#.#.....#.....#...#...#.....#.#...#...#...#...#.......#.......#.....#.#.......#.#...#.......#.#...#.#
#.#.#.###.###.###.###.#.#.#######.#######.#.###.#.#######.#.###.###.#.#.#.###.#.###.#####.#.#########.#.###.#.#########.#.###########.#.#.###
#.#.#.#...........#...#.#.#...#...#.....#...#...#.#...#...#...#.......#.#.....#.#...#...#.#...#...#.......................#.....#...#...#...#
#.#.#.#.#########.#.###.#.#.#.#.#.#.###.###.#.###.#.#.#.#.###.#.###.#########.#.#.###.#.#.#.#.#.#.#.###.#.###.#######.#.#.#.###.#.#.#######.#
#.#...#...#...#...#...#.....#.#.#.#.#.#.#...#.#...#.#.......................#.....#...#.#...#...#...#...#.....#...................#.......#.#
#.#.#####.#.#.#.#####.#########.#.#.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#######.#####.#.###.###.#.###.###.#######.#.###.#.#.#.#.#.#.#.#######.#.#
#...#...#.....#.................#.#.#.#.#.....#.....#.#.#.#.#.......#.....#.....#...#.#...#.#.....#...#.........#...#.#.....#...#...#...#.#.#
###.###.#####.#####.#####.#.#.#.#.#.#.#.#.#.#####.#####.###.#.#.###.#.###.###.#.#####.###.#.#.#####.###.#####.###.#####.#####.#####.#.#.#.#.#
#...#...#...#.......#.....#.#...#.#.#.#.......#...#.....#...#.#.#...#.#.#...#.#...#...#...#.#.....#.#.#...#.......#.....#.........#.#.#.....#
#.#.#.#.#.#.#########.###.#.#######.#.#.#####.#####.#####.###.###.###.#.###.#####.###.#.###.#####.#.#.###.#.#.#####.###.###########.#######.#
#.....................#...#.........................#...#...#.....#...#.............#.....#.....#.......#.#.#...#...#.......#.....#.....#.#.#
#######.###.###.#.#.#.###########.#.#.#####.#.#.#.###.#.###.#######.###.###.#.#.###.#####.#######.#######.#.#.#.#.#########.#.###.#####.#.#.#
#.................#.#.........#...#...#.....#...#.#...#.....#.....#.#.........#...#.....#.......#.#.#.....#...#.........#...#.#.#.....#.#.#.#
#.#.#.###.#####.###.#.#####.#.#.#####.#.#########.#.#######.#.#.#.#.###.#########.#####.#######.#.#.#.#######.#.#######.###.#.#.#####.#.#.#.#
#.#.#.....#...#.#.#...#...#.#.#.......#.......#...#.#.....#.#.#.#.#...#.#.....#.#.....#.#.....#.#...#...#.....#.......#...#...#.#...#.#.#.#.#
#.#.#######.#.#.#.#####.###.#.###########.#.#.#.###.#.###.#.#.#.#####.###.###.#.#.###.#.#####.#.###.###.###.#########.###.#####.#.#.#.#.#.#.#
#.#.#.......#.#.........#...#.....#...#...#.#.#.#.#...#...#...#...#...#.....#.#.#...#...#.....#...#...#...#.......#...#...#.......#...#.#...#
#.#.#.#######.###########.###.#####.#.#.###.#.#.#.#####.###.#####.#.###.#####.#.#.#.#####.#.#.###.###.###.###.#.###.###.###.#.###.###.#.###.#
#.#...#.....#...........#.....#.....#...#.#.#.#...#...#.#...#...#.#.....#...#.#...#.......#.....#.#.....#...#.#.#...#...#...#.....#.......#.#
#.#####.###.###########.#.#####.#########.#.#.###.#.#.#.#####.#.#.#######.#.#.#####.###.#######.#.#####.###.###.#.#.#.###.###.#.#####.###.#.#
#.......#...#...#.....#...#.....#.....#.....#...#.#.#.#.#...#.#.......#...#.#.....#...#...#.....#.#...#...#...#...#.#...#.#...#.#.........#.#
#.#.#########.#.#.#.#####.#.#####.#####.#######.#.#.#.#.#.#.#.#.#######.###.#####.###.###.#######.#.#.#.#####.#.###.#.#.#.#.###.###.#.#####.#
#.#...#.......#.#.....#...#.#...............#.#...#.#.#...#...#.#.......#.........#.....#.#.....#...#...#...#.....#.#.#.#.#.#.............#.#
#.###.#.#######.#.###.#.###.#.#############.#.#####.#.#######.###.###############.#####.#.#.###.###.###.#.#.#.###.#.#.#.#.#.#.###.###.#.#.###
#.#.#...#.....#...#.#...#...#.#...........#.........#.#...#...#...#.......#...........#.#...#.#.......#.#.#.#.#.#.#...#.#.#.#.#...#.....#...#
#.#.#####.###.#####.#####.#.###.#########.###########.#.#.#.###.###.#####.#.#######.#.#.#####.#.#####.#.#.#.#.#.#.#####.#.###.#.###.#######.#
#.....#.#...#.............#.....#.....#...#...#.....#...#.#...#.....#.....#...#.....#.#...#...#.#.....#...#.#.#.#.......#.#...#...#.#...#...#
#####.#.###.#####.#######.#########.#.#.###.#.#####.#####.###.#######.#######.#.#####.###.###.#.#.#########.#.#.#######.#.#.###.#.#.#.#.#.#.#
#.#...#...#...#...#.....#...#.......#.#...#.#.....#.........#.#.....#...#.#...#.#.....#.#.....#.#...#.#...#...#.......#.....#...#...#.#.#.#.#
#.#.#####.#.###.###.#####.#.#.#.#####.###.#.#####.#.#########.#.###.###.#.#.###.#.#####.#####.#.#.#.#.#.#.#####.#.###.#.#.###.###.#####.#.#.#
#.#.#...#...#...#...#.....#.#.#.#.....#.#...#...#.............#...#.#.#.#.....#.#.....#.....#.#.#...#...#.......#.#.....#...#...#.....#.#.#.#
#.#.#.#.#####.###.###.#.###.#.#.#.#####.#######.###########.#####.#.#.#.#######.#####.#.###.#.#.###.#########.#.#.#########.###.#.###.#.#.###
#.#.#.#.....#...#.....#.....#.#.#.#...............#.#.......#.....#...#.#.....#.....#.#...#.#.#...#.#.........#...#...#...#.#.....#.....#...#
#.#.#.#####.#.#.#########.#####.#.#.#############.#.#.#.###.#.#.#######.#.###.###.#.#.#####.#.###.#.#.#.#######.#.#.#.#.#.#.#.###.#.#######.#
#.#.#...#.#.#.#.....#...#.#.....#...#.....#...#.......#...#.#.#.#.....#...#.....#.#.#.....#.#...#.#...#.#.....#...#.#...#.#.#.#...#.#.......#
#.#.###.#.#.#######.#.#.#.#.#####.###.###.###.#.#########.###.#.#.###.#####.#.###.#.#####.#.###.#.#####.#.###.#.###.#####.#.#.#.#.###.#####.#
#.#.....#...#.....#...#.#...#.......#...#.....#.....#...#...#.#.#...#.......#.....#.....#.#.#...#...#...#.#.#.#...#...#...#.#.#.#...#.....#.#
#.#######.###.###.#####.#####.#.#####.#.#####.#.#.#.#.#.###.#.#.###.###.###.#######.#.#.#.#.#.#####.#####.#.#.#######.#.###.###.#.#.#.###.#.#
#.#...#...#.#...#.......#.....#.#.....#...#...#.#.#...#...#...#.......#...#.#.....#.#.#.#.#.......#.....#...#...........#...#...#...#.#...#.#
#.#.#.#.###.#.#.###.#####.#####.#.#######.#.###.#.#######.#.#######.#####.###.#.#.###.#.#.#.###.#####.#.###.###########.#.###.###.###.#.###.#
#...#.#.#.....#.#.............#.#.....#.#.#.#.#.#...#...#.#.#.....#.#...#.....#.#.#...#.#...#...#...#.#...........#.......#...#.#...#.#...#.#
#.###.#.###.###.###.###.###.#.#######.#.#.#.#.#.###.#.#.#.###.###.###.#.#.#####.#.#.#.#.#.###.#.#.#.###############.#####.#.###.#.#.#.###.#.#
#.#...#...#.#...#...#.#.....#...........#.#...#...#.#.#.......#.#.#...#.....#...#...#...#.....#...#.......#.......#.........#.....#.#...#.#.#
#.#.#####.#.#.#.#.###.###.#.#.#########.#.###.###.#.#.#####.###.#.#.#######.#.#.#########################.#.#.###.#############.#.#.#####.#.#
#...........#.#.............#...#.....#.#...#.#...#.#.#...#.....#...#.....#...#.#.....#.....#.........#...#...#.#.#...#.......#.#...#.....#.#
#.#####.#.###.#.###.#############.###.###.#.###.###.###.#.###.#######.###.#####.#.###.#.###.#.#######.#.###.#.#.#.#.#.#.#####.#.#.###.#####.#
#...#.#.#.....#.#.#.#.#...........#.....#.#...#...#.....#...#.........#...#.....#.#.....#.....#.....#...#.....#.#...#...#.....#...#.....#...#
###.#.#.#######.#.#.#.#.#.###.#.#######.#####.###.###.#####.###.#.#.#####.#.#####.#.###.###.#.###.###.#.#.#####.#####.###.#######.#.###.#####
#...#.#.........#...#.....#.#...#.....#.....#...#...#.....#...#.#...#...#.#.#...#.#.#.....#.#...#.#...#.#.......#.......#.#...#.......#.....#
#.#.#.#######.###.#.#####.#.#.###.###.#####.#.#####.#.#######.#####.#.#.###.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.###.#.#.#.#.#.#.#####.#.#.###.#
#.#.........#...#.........#...#...#...#.......#.....#.#.....#.....#.#.#.....#.#.#.#.#.#.#.#.#.#...#.#.#.....#.#...#...#.#...#.....#...#.#...#
#.###.#####.#.#.#####.#######.#.###.#########.#.#####.#.###.#.###.#.#.#######.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#####.#.#.#######.#.###.#.###
#...#.#.......#.#.....#.....#.#.#...#.....#...#...#.#.#...#.#...#.#.#.......#.#.#.#.#.#.#.....#.#...#.....#.#.#.....#.#.#...#.....#.....#...#
###.#.#######.#.#######.###.###.#.#.#.###.#######.#.#.###.#.###.#.#.#.#######.#.#.###.#.#######.#########.#.#.#####.#.#.###.#.#####.###.#.#.#
#...#.#.....#.#.#.......#.#.....#.#.#...#.#.......#...#.......#.#.#...#.......#.#.....#...#.#...#.......#.#.#.....#.#.#.#...#.#.........#.#.#
#.###.#.###.#.#.#.#######.#######.#####.#.#.#######.#.#.#####.###.#.###.#######.#.#####.#.#.#.#.#.#####.#.#.#####.#.#.#.#.###.#.###.#.#.#.#.#
#.#.......#.#.#...#...........#.#.......#...#.....#...#.#.........#...#...#...#.#...#...#...#.#.#.#...#.#...#.#...#.#.#.#.#...#.#...#...#.#.#
#.#########.#.###.###.#.#.###.#.#.#######.#.#####.#.###.#############.###.#.###.###.###.###.#.###.#.#.#.#.###.#.###.#.#.###.###.#.#.###.###.#
#...#.......#...#...#...#...#.#.......#...#...#...#.#.#.....#...#...#.#.#.#.....#.#...#.#...#...#...#.#.#...#.#.#.#.#.....#...#.#.#...#.....#
###.#.#####.###.#.#.#######.#.#####.#.#.#.###.#.###.#.#####.#.#.#.#.#.#.#.#.#####.###.#.#.#####.#.#####.###.#.#.#.#.#####.#.#.#.#.#.#.#.#####
#.#.#.#.#.....#...#.#...#...#...#...#.#...#...#...#.#.....#.#.#...#.#...#.#...#.....#.#.#.#...#...#.......#...#.#.#.....#.#.#.#.#.#.#.......#
#.#.#.#.#.#.#.#####.#.#.#.#####.#.#.#####.#.###.#.#.#.#.#.#.#.###.#.###.#.###.###.#.#.#.#.#.#.#####.#.###.#####.#.#####.#.###.#.#.#.###.###.#
#.#...#.#.#.#...#...#.#...#...#...#.......#.#...#...#.#.#...#...#.#.#...#...#...#.#.#...#.#.#.....#.#...#.#.....#.....#.#...#...............#
#.#####.#.#.###.#.###.#####.#.#.#.#.#######.###.#####.#.#.#####.#.#.#.#####.###.#.###.#####.#####.#.###.#.#.#.#.#.#####.###.#.#.#.###.#.###.#
#.....................#...#.#.#...#.......#...#.#.......#.....#.#.#...#.....#...#.....#.....#...#...#.#.#...#.....#.....#...#.#.#...#.#.#...#
#.#.###.#.#.#.#.#######.###.#.###.#######.###.#.#.#########.###.#.###.#.#####.#########.#####.#.#####.#.###########.#####.###.#####.#.#.#.#.#
#.#.#.#.#...#.#.....#.......#...#.#.#.....#...#...#...#.....#...#...#.#.....#.#.........#.....#.#.....#.#.......#...#.....#.......#...#.#.#.#
#.#.#.#.#.#.#.#####.#.#########.#.#.#.#####.###.###.#.#.#.###.#####.#.#####.#.#.#########.#.###.#.###.#.#.#####.#.###.###.#######.#.###.#.#.#
#.#...#.....#.#...#...#.....#...#...#.#.......#.#...#...#.#...#.#...#.#.....#...#.......#.#.#.#...#.#.#...#...#.#...#.............#.#.....#.#
#.###.###.###.#.#.#.###.#####.#####.#.#.#.###.#.#.#########.###.#.###.###############.#.#.#.#.#####.#.#####.#.#.#.#.#############.#.#.#.#####
#.....#.......#.#...#.#.....#.......#...#...#.#.#.......#...#...#...#...#...........#.#.#.#.#.......#.......#.#.#.#.....#.........#.#.......#
#.#####.#.#####.#####.#.###.#############.###.#.#######.#.###.#.###.###.#######.#.#.###.#.#.#####.###########.#.###.###.###########.###.###.#
#.#...#.#.......#.........#.............#.....#...#...#.#.#...#...#...#.......#.#.#...#.#.#.....#.........#...#...#...#.................#...#
#.#.#.#.#.#######.#######.#####.#.###############.#.#.#.#.###.#######.#######.#.#.###.#.#.#####.#.#####.#.#.#####.###.#####.#############.###
#.#.#.#...#.#.......#...#.#...#.#.........#.........#.#.#...#.......#...#.....#.#.#.#.#.......#.#.#.....#.........#.#...#...............#...#
#.#.#.#.#.#.#.#.#####.#.###.#.#.###.#####.#.#########.#.###.#.#.###.###.#.#######.#.#.#######.#.#.#.#####.###.#####.#.###.#############.#.#.#
#.#.#...#...#.....#...#.....#...#...#...#.......#.....#.#...#.....#.#...#.#.......#.#...#.#...#.#.#.......#...#.......#...#...........#.....#
#.#.###.#.#######.#.#########.#.#.###.#######.#.###.###.#.#######.#.#.###.#.#######.###.#.#.###.#.###.#.###.###.#######.###.#####.#######.#.#
#.#.#...#.........#.#.........#.#...#.......#.#...#...#.#...#.....#.#.#...#.#.....#.....#...#...#...#...#...#...#...#.#...#.....#.#.......#.#
#.#.#.#.#.#######.#.#####.#####.###.#.#.#####.###.#####.###.#.#####.#.#.###.#.###.#.#####.###.#####.#.###.###.###.#.#.###.#.#####.#.#.###.#.#
#.#.#.....#.....#.#.....#.#.......#.#.#.#.....#.....#.....#.#...#...#.#...#.#...#.#.....#.#.#...#.#.#.......#.#...#.#...#.#.......#.#...#.#.#
#.#.#.#.#.#.###.#######.#.###.#.#.#.#.#.#.#########.#.###.#.#.###.#.#.###.#.#.#.#.#####.#.#.###.#.#.###.###.#.#.###.#.#.#.#.#.###.#.#.#.#.#.#
#.#...#.....#.#.#.....#.#...#.#.#.#.#.#.#...#.....#...#.#.#.#.#...#.#.#.#...#.#.......#.#...#...#.#.#...#.#.#...#.#...#.#.#.#.#...#.#.#.#.#.#
#.###.#######.#.#.###.#.###.###.#.#.###.###.#.###.#####.#.#.#.#.#####.#.#.#.#.#####.###.#####.###.#.#.#.#.#.#####.###.#.#.#.#.#.###.#.#.#.#.#
#.#...#...#.......#.#...#.#...#.#.#.....#.#.....#.....#...#.#.#.#.....#.#...#.....#.....#...#...#.#...#...#.#.#.......#...#.#.#.#...#.#.....#
#.#.###.#.#########.#.###.###.#.#######.#.#####.#####.#.###.###.#.#####.#.###########.###.#.###.#.###.#####.#.#.#######.#####.###.###.###.###
#.#...#.#.#.....#.........#...#...........#...#.....#.#...#...#.#.#.......#...#.....#.....#...#.#.....#...#.#...#...#...#.....#...#.........#
#.###.#.#.#.###.#.#.#####.#.#####.#.#####.#.#.###.###.#######.#.#.###.#####.#.#.###.#########.#.#####.#.#.#.#.#####.#.###.#.###.###.#.#####.#
#...#...#.#.#...#.#.....#.#.#.....#.#...#.#.#...#.#...#.........#...#.#.....#.......#.#.....#.#.....#.#.#...#.....#.#.#.#.#...#.#.#.#.......#
###.#####.#.#.###.#####.###.#.###.###.#.###.###.#.#.#.#.###########.#.#.#########.###.#.###.#.#####.#.#.#######.#.#.#.#.#.###.#.#.#.#.#####.#
#...#...#.#.#...#.....#.#.............#...#.#.#.#.#.#.#...#.........#.#.....#.#...#...#.#.#.#.....#.#.#...#.#...#.#.#.#.....#.........#.....#
#.###.#.#.#.###.#######.#.#####.#########.#.#.#.###.###.#.#.#########.#####.#.#.###.#.#.#.#.#####.#.#####.#.#.#.#.#.#.#####.#####.###.###.###
#.#...#.#.....#.......#.#...#.......#...#...#.#.....#...#.#.......#.#.....#...#...#.#.....#.....#...#.....#...#...#.......#.#.......#...#...#
#.###.#.#############.#.###.#.#####.#.#######.#.#####.###.#######.#.#.#####.#####.#.#######.#.#####.#.#####.#######.#####.#.###.#####.#.#####
#.#...#.#.....#.......#.#...#.#...#.#.......#...#...#.....#.....#.....#.....#.....#.....#...#.#.....#.....#.#.......#...#.#...#...#...#.#...#
#.#.###.#.###.#.#######.#.###.#.###.#.###.###.###.#.###.###.#.#.#.#####.#####.#####.###.#.###.#.#########.#.#####.#.#.###.###.###.#.#.#.#.#.#
#...#...#...#.....#...#...#...#...#.#...#.....#.......#.#...#.....#.....#...#.....#.#.......#.#.....#...#.#.....#.#...#...#...#...#.#...#.#.#
#####.###.#.#####.#.#.#.###.###.#.#.#####.#####.#####.#.#.#########.#######.#####.###.#.#.#.#######.###.#.#####.#.#####.###.###.###.#.###.#.#
#.....#...#...#.....#.....#.#...#.#.......#.......#.#...#.........#...........#.#.#...#.#.#.................#...#.#.....#.#.#.#.#.#.#.#...#.#
#.#####.#####.#############.#####.#####.#.#.#####.#.#####.#####.#.###########.#.#.#.###.#.#################.#.###.#.#####.#.#.#.#.#.#.#.###.#
#.#...#.....#.#.................#.#...#.#...#...#.....#.......#.#...........#...#...#...#.........#...#.....#...#.#.#.......#.....#.....#...#
#.###.###.###.#.#######.#######.#.#.#.#######.#.#######.#####.#.#########.#####.#####.#########.#.#.#.#.#######.#.#.###.#################.#.#
#...#.....#...#...#...#...#.......#.#.........#.........#...#.#.....#...#...#...#...#.#.........#...#...#...#.....#...#.........#.....#...#.#
###.#.#####.###.#.#.###.#.###.#####.#####.#################.#.#####.###.###.#.###.#.#.#####.#####.###.###.#.#########.#########.#.###.#.#####
#...#.#...#.........#.......#.#...#.....#.#.......#.........#.#...#.......#.#.#...#.#.....#.....#.#.......#...#.......#.........#...#.#.....#
#.###.#.#############.#.###.###.#.#.###.#.#.#####.#####.#.#.#.#.#.#####.###.#.#.#.#.#####.#####.#.#.#########.#.#######.###########.#.###.#.#
#...#.#.....#...#.....#...#.....#.#.#...#.#.#...#.....#.#.#.#...#.#...#.#...#.#.#...#.....#.....#.....#.....#.#.....#...............#...#.#.#
###.#.#####.#.#.#.#####.#.#####.#.#.#.###.#.###.#####.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.###.#.###.###.#####.#.#.###.#######.###########.###.#
#.#.#.......#.#...#.....#.....#...#.#...#.#.....#.....#.#.......#.#.#...#...#...#.#...#.#...#.....#...#...#...#.#...#...#.........#.#...#...#
#.#.#########.#####.#########.#.#######.###.#####.#####.#######.#.#.#######.#####.#.###.#.#########.###.#.###.###.###.#.#####.###.#.#.###.###
#.#.......#...#.....#.......#.#.......#.....#.....#.....#.....#.#.#.......#...#...#.#...#.....#.......#.#...#...#.....#.....#.#.....#.#.....#
#.#.#####.#.###.#.###.#####.#####.###.###.###.#####.#.#.#.###.###.#.#####.#.#.#.#.#.#.#######.#######.#.###.###.###.#######.#.#.#####.#####.#
#.....#...#.#...#.....#...#.#...#...#...#...#.#.....#.#.#...#.....#.....#.#...#.#...#...#.....#...#...#.#...#.....#.#.......#.#...#...#...#.#
#.#.#.#.###.#.###########.#.#.#.#.#.###.###.#.#####.#.#####.###########.#.#.#.#.#.#####.#.#.###.#.#.###.#.#######.###.###.###.###.#.###.#.#.#
#...#.#.....#.....#.....#.#...#...#.#...#.#.#.#...#.#.......#.#...........#.#.#.#.#.#.....#.....#.#...#.#.....#.......#.......#...#.#...#...#
#.#.#############.###.#.#.#########.#.###.#.#.#.#.#.###.###.#.#.#.#######.#.###.#.#.#.###########.###.#.#####.###########.#.#######.#.#.###.#
#.#...#.........#.....#.......#...#...#.....#...#.#...#...#.#.....#.....#.#.#...#.#...#.........#.#...#.#...#.........#...#.#...#...#.#.#...#
#.#.#.#.#.###.###############.###.#####.#########.###.###.#.#####.#.###.###.#.###.#.###.###.#####.#.###.###.#########.#.#####.#.#.###.#.###.#
#...#.#.#...#.#.........#.....#...#.....#.......#.#...#...#.#...#...#.#...#.#.#.......#.#.#.......#...............#...#.....#.#.#.#.#.#...#.#
#####.#.#.###.#.#######.#.#####.#.#.#########.#.#.#.###.#.#.#.#.###.#.###.#.#.#.#####.#.#.#############.#########.#.#.#####.#.#.#.#.#.###.#.#
#.....#.#...#...#.....#...#.....#.....#.......#...#.#...#.#...#.....#...#...#.#.#...#.#.....#.........#.#.......#.#.#.......#.#...#.....#.#.#
#.#.#.#.#.#.#####.###.#######.#.#####.#.#########.###.#####.#########.#.#.###.#.#.#.#######.#.#######.#.#.#####.###.#.#.#.###.###########.#.#
#.#.#.#.#.#.#.....#.....#...#.#.....#.#.........#...#.......#.......#.#.#.#...#...#.....#...#...#...#.#.#.....#.....#.#.#.#...#...#.......#.#
#.#.#.#.#.#.#.###.#.###.#.#.#####.#.#.#.#######.###.#####.#.#.#####.#.###.#.#########.###.###.#.#.###.#.#####.#######.#.#.#.###.#.#.#######.#
#.#...#.#.#.......#...#...#.#...#.#...#.......#...#.....#.#...#...#.#.....#.........#.....#...#.#.....#.#...#...#.....#.#.#.....#.#.....#...#
#.###.#.#.#######.###.#####.#.#.#.#.#############.#####.#.#.###.#.#.#.###.#########.###########.#.#######.#.#.#.#.#####.#########.#####.#.#.#
#.#...#.....#.......................#.......#.........#.#.#.#...#.#.#...#.#...#...#.....#.....#.....#...#.........................#.....#...#
#.#.#.###.#.#.###.#.###.#######.#.#.#.#####.#.#.#######.###.#.###.#.#.#.#.#.###.#.#####.#.###.#.###.#.#.#.###.#.###.#.#.#.###.#.###.#########
#...#.#...#.#...#...#...#.......#.#...#.#.....#.#.....#.#...#.#.#.#...#.#...#...#.....#.#...#...#...#.#.#.#...#.#.#.#.#.#.#.#...#.....#.....#
#.#.###.#.#.#.###.###.#.#.#######.#.###.#.#######.###.#.#.#.#.#.#.###.#.#####.###.#.###.#.#.#####.###.#.#.#.#.#.#.#.#.#.#.#.#######.#.#.###.#
#.................#.........#.......#.......#.........#.......#.....#.#.....#.....#.....#.#.#...#.#...#...#...#.#.#...#...#.......#.#...#...#
###.#.###.#####.###.#.#.###.#.#####.#######.#.#####.#######.#######.#.#####.#####.#######.#.###.#.#.#.#######.#.#.###.#####.#.###.#######.#.#
#...#.#.#.....#.#.....#.#...#.#...#.....#...#...#.#.#.....#.#.....#.......#.......#...#...#...#.#.#.#...#...#...#...#.#.....#...............#
#.#.#.#.#.#.#.#.#.#####.#.#####.#.#.###.#######.#.#.#.###.###.###.#.#.#####.###.#.#.#.#######.#.#.#####.#.###.#####.#.#########.###.#######.#
#.#...#...#.#.#.#.#...#...#.......................#...#...#...#.#.#.#...#...#.#.#.#.#.............#...#.#...........#.#...#...#.#.....#...#.#
#.#.#####.#.#.#.#.###.#####.#####.#.#.#######.#.#.#####.###.###.#.###.#.#.###.#.#.#.#.#.###.#.#.###.#.#.#.###.#######.#.#.#.#.#.#.###.#.#.#.#
#S..........#...#...........#.......#...........#...........#.........#...#.....#...#...#.....#.....#...#...............#...#...#...#...#...#
#############################################################################################################################################\
"""

if __name__ == "__main__":
    inp = input
    ans1, vertices = solution1(inp)
    print(ans1)

    ans2 = solution2(inp, vertices)
    print(ans2)
